{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import AuthContext from'../../context/AuthContext';// Import the authentication context\nimport apiServiceInstance from'../../context/ApiService';// Import the ApiService\nimport'./ProfilePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProfilePage(){const{isAuthenticated}=useContext(AuthContext);// Get authentication state\nconst[purchases,setPurchases]=useState([]);const[error,setError]=useState('');useEffect(()=>{if(isAuthenticated){fetchUserIdAndPurchases();// Fetch userId and then purchases\n}},[isAuthenticated]);const fetchUserIdAndPurchases=async()=>{try{// Zuerst Benutzerinformationen abfragen\nconst userResponse=await apiServiceInstance.getCurrentUser();const userId=userResponse.data.id;// assuming user ID is returned as `id`\n// Dann Bestellungen des Nutzers abrufen\nconst orderResponse=await apiServiceInstance.getOrdersByUserId(userId);if(orderResponse.status===200){setPurchases(orderResponse.data);// Assuming the API returns an array of purchases\n}else{setError('Failed to load purchases.');}}catch(err){setError('An error occurred while fetching purchases.');}};if(!isAuthenticated){return/*#__PURE__*/_jsx(\"p\",{children:\"You need to log in to view your purchases.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Purchases\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"ul\",{className:\"purchase-list\",children:purchases.map(purchase=>/*#__PURE__*/_jsxs(\"li\",{className:\"purchase-item\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Item:\"}),\" \",purchase.itemName]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\" $\",purchase.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",new Date(purchase.date).toLocaleDateString()]})]},purchase.id))})]});}export default ProfilePage;","map":{"version":3,"names":["React","useContext","useEffect","useState","AuthContext","apiServiceInstance","jsx","_jsx","jsxs","_jsxs","ProfilePage","isAuthenticated","purchases","setPurchases","error","setError","fetchUserIdAndPurchases","userResponse","getCurrentUser","userId","data","id","orderResponse","getOrdersByUserId","status","err","children","className","map","purchase","itemName","price","Date","date","toLocaleDateString"],"sources":["C:/Users/fr/website-react/react-website/src/components/ProfilePage/ProfilePage.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport AuthContext from '../../context/AuthContext'; // Import the authentication context\r\nimport apiServiceInstance from '../../context/ApiService'; // Import the ApiService\r\nimport './ProfilePage.css';\r\n\r\nfunction ProfilePage() {\r\n  const { isAuthenticated } = useContext(AuthContext); // Get authentication state\r\n  const [purchases, setPurchases] = useState([]);\r\n  const [error, setError] = useState('');\r\n \r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      fetchUserIdAndPurchases(); // Fetch userId and then purchases\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  const fetchUserIdAndPurchases = async () => {\r\n    try {\r\n      // Zuerst Benutzerinformationen abfragen\r\n      const userResponse = await apiServiceInstance.getCurrentUser();\r\n      const userId = userResponse.data.id; // assuming user ID is returned as `id`\r\n     \r\n\r\n      // Dann Bestellungen des Nutzers abrufen\r\n      const orderResponse = await apiServiceInstance.getOrdersByUserId(userId);\r\n      if (orderResponse.status === 200) {\r\n        setPurchases(orderResponse.data); // Assuming the API returns an array of purchases\r\n      } else {\r\n        setError('Failed to load purchases.');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while fetching purchases.');\r\n    }\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return <p>You need to log in to view your purchases.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <h2>Your Purchases</h2>\r\n      {error && <p className=\"error-message\">{error}</p>}\r\n      <ul className=\"purchase-list\">\r\n        {purchases.map((purchase) => (\r\n          <li key={purchase.id} className=\"purchase-item\">\r\n            <p><strong>Item:</strong> {purchase.itemName}</p>\r\n            <p><strong>Price:</strong> ${purchase.price}</p>\r\n            <p><strong>Date:</strong> {new Date(purchase.date).toLocaleDateString()}</p>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC9D,MAAO,CAAAC,WAAW,KAAM,2BAA2B,CAAE;AACrD,MAAO,CAAAC,kBAAkB,KAAM,0BAA0B,CAAE;AAC3D,MAAO,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3B,QAAS,CAAAC,WAAWA,CAAA,CAAG,CACrB,KAAM,CAAEC,eAAgB,CAAC,CAAGV,UAAU,CAACG,WAAW,CAAC,CAAE;AACrD,KAAM,CAACQ,SAAS,CAAEC,YAAY,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACW,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAGtCD,SAAS,CAAC,IAAM,CACd,GAAIS,eAAe,CAAE,CACnBK,uBAAuB,CAAC,CAAC,CAAE;AAC7B,CACF,CAAC,CAAE,CAACL,eAAe,CAAC,CAAC,CAErB,KAAM,CAAAK,uBAAuB,CAAG,KAAAA,CAAA,GAAY,CAC1C,GAAI,CACF;AACA,KAAM,CAAAC,YAAY,CAAG,KAAM,CAAAZ,kBAAkB,CAACa,cAAc,CAAC,CAAC,CAC9D,KAAM,CAAAC,MAAM,CAAGF,YAAY,CAACG,IAAI,CAACC,EAAE,CAAE;AAGrC;AACA,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAjB,kBAAkB,CAACkB,iBAAiB,CAACJ,MAAM,CAAC,CACxE,GAAIG,aAAa,CAACE,MAAM,GAAK,GAAG,CAAE,CAChCX,YAAY,CAACS,aAAa,CAACF,IAAI,CAAC,CAAE;AACpC,CAAC,IAAM,CACLL,QAAQ,CAAC,2BAA2B,CAAC,CACvC,CACF,CAAE,MAAOU,GAAG,CAAE,CACZV,QAAQ,CAAC,6CAA6C,CAAC,CACzD,CACF,CAAC,CAED,GAAI,CAACJ,eAAe,CAAE,CACpB,mBAAOJ,IAAA,MAAAmB,QAAA,CAAG,4CAA0C,CAAG,CAAC,CAC1D,CAEA,mBACEjB,KAAA,QAAKkB,SAAS,CAAC,cAAc,CAAAD,QAAA,eAC3BnB,IAAA,OAAAmB,QAAA,CAAI,gBAAc,CAAI,CAAC,CACtBZ,KAAK,eAAIP,IAAA,MAAGoB,SAAS,CAAC,eAAe,CAAAD,QAAA,CAAEZ,KAAK,CAAI,CAAC,cAClDP,IAAA,OAAIoB,SAAS,CAAC,eAAe,CAAAD,QAAA,CAC1Bd,SAAS,CAACgB,GAAG,CAAEC,QAAQ,eACtBpB,KAAA,OAAsBkB,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC7CjB,KAAA,MAAAiB,QAAA,eAAGnB,IAAA,WAAAmB,QAAA,CAAQ,OAAK,CAAQ,CAAC,IAAC,CAACG,QAAQ,CAACC,QAAQ,EAAI,CAAC,cACjDrB,KAAA,MAAAiB,QAAA,eAAGnB,IAAA,WAAAmB,QAAA,CAAQ,QAAM,CAAQ,CAAC,KAAE,CAACG,QAAQ,CAACE,KAAK,EAAI,CAAC,cAChDtB,KAAA,MAAAiB,QAAA,eAAGnB,IAAA,WAAAmB,QAAA,CAAQ,OAAK,CAAQ,CAAC,IAAC,CAAC,GAAI,CAAAM,IAAI,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,kBAAkB,CAAC,CAAC,EAAI,CAAC,GAHrEL,QAAQ,CAACR,EAId,CACL,CAAC,CACA,CAAC,EACF,CAAC,CAEV,CAEA,cAAe,CAAAX,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}