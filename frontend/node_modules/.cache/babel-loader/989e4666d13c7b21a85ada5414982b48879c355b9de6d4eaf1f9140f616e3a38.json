{"ast":null,"code":"// src/pages/ProfilePage/ProfilePage.js\nimport React,{useContext,useEffect,useState}from'react';import AuthContext from'../../context/AuthContext';// Import the authentication context\nimport'./ProfilePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProfilePage(){const{isAuthenticated}=useContext(AuthContext);// Get authentication state\nconst[purchases,setPurchases]=useState([]);const[error,setError]=useState('');useEffect(()=>{if(isAuthenticated){// Fetch purchases when component mounts\nfetchUserPurchases();}},[isAuthenticated]);const fetchUserPurchases=async()=>{try{const token=localStorage.getItem('token');const response=await fetch('/api/purchases',{method:'GET',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`// Include token for authentication\n}});const data=await response.json();if(response.ok){setPurchases(data.purchases);// Assuming your API returns an array of purchases\n}else{setError(data.message||'Failed to load purchases.');}}catch(err){setError('An error occurred while fetching purchases.');}};if(!isAuthenticated){return/*#__PURE__*/_jsx(\"p\",{children:\"You need to log in to view your purchases.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Purchases\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"ul\",{className:\"purchase-list\",children:purchases.map(purchase=>/*#__PURE__*/_jsxs(\"li\",{className:\"purchase-item\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Item:\"}),\" \",purchase.itemName]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Price:\"}),\" $\",purchase.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",new Date(purchase.date).toLocaleDateString()]})]},purchase.id))})]});}export default ProfilePage;","map":{"version":3,"names":["React","useContext","useEffect","useState","AuthContext","jsx","_jsx","jsxs","_jsxs","ProfilePage","isAuthenticated","purchases","setPurchases","error","setError","fetchUserPurchases","token","localStorage","getItem","response","fetch","method","headers","data","json","ok","message","err","children","className","map","purchase","itemName","price","Date","date","toLocaleDateString","id"],"sources":["C:/Users/fr/website-react/react-website/src/components/ProfilePage/ProfilePage.jsx"],"sourcesContent":["// src/pages/ProfilePage/ProfilePage.js\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport AuthContext from '../../context/AuthContext'; // Import the authentication context\r\nimport './ProfilePage.css';\r\n\r\nfunction ProfilePage() {\r\n  const { isAuthenticated } = useContext(AuthContext); // Get authentication state\r\n  const [purchases, setPurchases] = useState([]);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      // Fetch purchases when component mounts\r\n      fetchUserPurchases();\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  const fetchUserPurchases = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await fetch('/api/purchases', {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`, // Include token for authentication\r\n        },\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (response.ok) {\r\n        setPurchases(data.purchases); // Assuming your API returns an array of purchases\r\n      } else {\r\n        setError(data.message || 'Failed to load purchases.');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while fetching purchases.');\r\n    }\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return <p>You need to log in to view your purchases.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"profile-page\">\r\n      <h2>Your Purchases</h2>\r\n      {error && <p className=\"error-message\">{error}</p>}\r\n      <ul className=\"purchase-list\">\r\n        {purchases.map((purchase) => (\r\n          <li key={purchase.id} className=\"purchase-item\">\r\n            <p><strong>Item:</strong> {purchase.itemName}</p>\r\n            <p><strong>Price:</strong> ${purchase.price}</p>\r\n            <p><strong>Date:</strong> {new Date(purchase.date).toLocaleDateString()}</p>\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProfilePage;\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC9D,MAAO,CAAAC,WAAW,KAAM,2BAA2B,CAAE;AACrD,MAAO,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3B,QAAS,CAAAC,WAAWA,CAAA,CAAG,CACrB,KAAM,CAAEC,eAAgB,CAAC,CAAGT,UAAU,CAACG,WAAW,CAAC,CAAE;AACrD,KAAM,CAACO,SAAS,CAAEC,YAAY,CAAC,CAAGT,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACU,KAAK,CAAEC,QAAQ,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CAEtCD,SAAS,CAAC,IAAM,CACd,GAAIQ,eAAe,CAAE,CACnB;AACAK,kBAAkB,CAAC,CAAC,CACtB,CACF,CAAC,CAAE,CAACL,eAAe,CAAC,CAAC,CAErB,KAAM,CAAAK,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CACF,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,gBAAgB,CAAE,CAC7CC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,CAAE,UAAUN,KAAK,EAAI;AACtC,CACF,CAAC,CAAC,CAEF,KAAM,CAAAO,IAAI,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAClC,GAAIL,QAAQ,CAACM,EAAE,CAAE,CACfb,YAAY,CAACW,IAAI,CAACZ,SAAS,CAAC,CAAE;AAChC,CAAC,IAAM,CACLG,QAAQ,CAACS,IAAI,CAACG,OAAO,EAAI,2BAA2B,CAAC,CACvD,CACF,CAAE,MAAOC,GAAG,CAAE,CACZb,QAAQ,CAAC,6CAA6C,CAAC,CACzD,CACF,CAAC,CAED,GAAI,CAACJ,eAAe,CAAE,CACpB,mBAAOJ,IAAA,MAAAsB,QAAA,CAAG,4CAA0C,CAAG,CAAC,CAC1D,CAEA,mBACEpB,KAAA,QAAKqB,SAAS,CAAC,cAAc,CAAAD,QAAA,eAC3BtB,IAAA,OAAAsB,QAAA,CAAI,gBAAc,CAAI,CAAC,CACtBf,KAAK,eAAIP,IAAA,MAAGuB,SAAS,CAAC,eAAe,CAAAD,QAAA,CAAEf,KAAK,CAAI,CAAC,cAClDP,IAAA,OAAIuB,SAAS,CAAC,eAAe,CAAAD,QAAA,CAC1BjB,SAAS,CAACmB,GAAG,CAAEC,QAAQ,eACtBvB,KAAA,OAAsBqB,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC7CpB,KAAA,MAAAoB,QAAA,eAAGtB,IAAA,WAAAsB,QAAA,CAAQ,OAAK,CAAQ,CAAC,IAAC,CAACG,QAAQ,CAACC,QAAQ,EAAI,CAAC,cACjDxB,KAAA,MAAAoB,QAAA,eAAGtB,IAAA,WAAAsB,QAAA,CAAQ,QAAM,CAAQ,CAAC,KAAE,CAACG,QAAQ,CAACE,KAAK,EAAI,CAAC,cAChDzB,KAAA,MAAAoB,QAAA,eAAGtB,IAAA,WAAAsB,QAAA,CAAQ,OAAK,CAAQ,CAAC,IAAC,CAAC,GAAI,CAAAM,IAAI,CAACH,QAAQ,CAACI,IAAI,CAAC,CAACC,kBAAkB,CAAC,CAAC,EAAI,CAAC,GAHrEL,QAAQ,CAACM,EAId,CACL,CAAC,CACA,CAAC,EACF,CAAC,CAEV,CAEA,cAAe,CAAA5B,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}